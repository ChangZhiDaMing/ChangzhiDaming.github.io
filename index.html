<!doctype html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>明亮眼镜 - 专业配镜，清晰视界</title>

    <!-- SEO / Social -->
    <meta name="description" content="长治·大明眼镜 — 30年专业配镜经验，提供专业验光、AR试戴与会员专享服务。立即预约，体验清晰视界。">
    <link rel="canonical" href="https://changzhidaming.github.io/">
    <meta property="og:title" content="明亮眼镜 - 专业配镜，清晰视界">
    <meta property="og:description" content="长治·大明眼镜 — 30年专业配镜经验，提供专业验光、AR试戴与会员专享服务。">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://changzhidaming.github.io/">
    <meta property="og:image" content="/assets/og-image.jpg">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="明亮眼镜 - 专业配镜，清晰视界">
    <meta name="twitter:description" content="长治·大明眼镜 — 30年专业配镜经验，提供专业验光、AR试戴与会员专享服务。">
    <meta name="twitter:image" content="/assets/og-image.jpg">

    <!-- Favicon -->
    <link rel="icon" href="/favicon.ico">

    <!-- Preconnect / Performance hints -->
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>

    <!-- Tailwind (cdn used for quick deploy; consider compiling for production) -->
    <script>
        tailwind = window.tailwind || {};
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#1E40AF',
                        secondary: '#3B82F6',
                        accent: '#60A5FA',
                        neutral: '#F3F4F6',
                        'neutral-dark': '#9CA3AF'
                    },
                    fontFamily: {
                        sans: ['Inter', 'system-ui', 'sans-serif'],
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.5s ease-in-out',
                        'slide-up': 'slideUp 0.5s ease-in-out',
                    },
                    keyframes: {
                        fadeIn: {
                            '0%': { opacity: '0' },
                            '100%': { opacity: '1' },
                        },
                        slideUp: {
                            '0%': { transform: 'translateY(20px)', opacity: '0' },
                            '100%': { transform: 'translateY(0)', opacity: '1' },
                        }
                    }
                }
            }
        }
    </script>
    <script src="https://cdn.tailwindcss.com" defer></script>

    <!-- Font Awesome (consider replacing with SVG icons for performance) -->
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet" crossorigin="anonymous">

    <!-- Chart.js (defer) -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js" defer></script>

    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto { content-visibility: auto; }
            .text-shadow { text-shadow: 0 2px 4px rgba(0,0,0,0.1); }
            .glass-effect {
                background: rgba(255, 255, 255, 0.25);
                backdrop-filter: blur(10px);
                border: 1px solid rgba(255, 255, 255, 0.18);
            }
            .card-hover { transition: all 0.3s ease; }
            .card-hover:hover { transform: translateY(-5px); box-shadow: 0 10px 25px -5px rgba(59, 130, 246, 0.4); }
            .gradient-bg { background: linear-gradient(135deg, #1E40AF 0%, #3B82F6 100%); }
            .gradient-text {
                background-clip: text; -webkit-background-clip: text; -webkit-text-fill-color: transparent;
                background-image: linear-gradient(135deg, #1E40AF 0%, #3B82F6 100%);
            }
        }

        /* prefers-reduced-motion support */
        @media (prefers-reduced-motion: reduce) {
            .animate-fade-in, .animate-slide-up, .card-hover { animation: none !important; transition: none !important; }
        }

        /* Simple accessible focus styles */
        :focus { outline: 3px solid rgba(59,130,246,0.3); outline-offset: 2px; }
    </style>
</head>
<body class="font-sans bg-gray-50">

    <!-- NAV -->
    <nav class="bg-white shadow-md sticky top-0 z-50" role="navigation" aria-label="主导航">
        <div class="container mx-auto px-4">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center space-x-2">
                    <i class="fa fa-eye text-primary text-3xl" aria-hidden="true"></i>
                    <span class="text-2xl font-bold text-primary">长治·大明眼镜</span>
                </div>

                <div class="hidden md:flex items-center space-x-8" role="menubar" aria-label="桌面导航">
                    <a href="#home" class="text-gray-700 hover:text-primary font-medium transition-colors" role="menuitem">首页</a>
                    <a href="#products" class="text-gray-700 hover:text-primary font-medium transition-colors" role="menuitem">产品展示</a>
                    <a href="#services" class="text-gray-700 hover:text-primary font-medium transition-colors" role="menuitem">预约服务</a>
                    <a href="#ar-tryon" class="text-gray-700 hover:text-primary font-medium transition-colors" role="menuitem">AR试戴</a>
                    <a href="#membership" class="text-gray-700 hover:text-primary font-medium transition-colors" role="menuitem">会员中心</a>
                </div>

                <div class="flex items-center space-x-4">
                    <button class="hidden md:block bg-primary hover:bg-blue-700 text-white px-6 py-2 rounded-full transition-colors" aria-label="预约验光">
                        <i class="fa fa-phone mr-2" aria-hidden="true"></i>预约验光
                    </button>
                    <div class="relative">
                        <button class="text-gray-700 hover:text-primary" aria-label="用户账户">
                            <i class="fa fa-user-circle text-2xl" aria-hidden="true"></i>
                        </button>
                    </div>
                    <button class="md:hidden text-gray-700 hover:text-primary" id="mobile-menu-button" aria-controls="mobile-menu" aria-expanded="false" aria-label="打开菜单">
                        <i class="fa fa-bars text-2xl" aria-hidden="true"></i>
                    </button>
                </div>
            </div>

            <div class="md:hidden hidden" id="mobile-menu" aria-hidden="true">
                <div class="flex flex-col space-y-4 py-4">
                    <a href="#home" class="text-gray-700 hover:text-primary font-medium transition-colors">首页</a>
                    <a href="#products" class="text-gray-700 hover:text-primary font-medium transition-colors">产品展示</a>
                    <a href="#services" class="text-gray-700 hover:text-primary font-medium transition-colors">预约服务</a>
                    <a href="#ar-tryon" class="text-gray-700 hover:text-primary font-medium transition-colors">AR试戴</a>
                    <a href="#membership" class="text-gray-700 hover:text-primary font-medium transition-colors">会员中心</a>
                    <button class="bg-primary hover:bg-blue-700 text-white px-6 py-2 rounded-full transition-colors w-full" aria-label="预约验光(移动版)">
                        <i class="fa fa-phone mr-2" aria-hidden="true"></i>预约验光
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- HERO -->
    <section id="home" class="relative bg-gradient-to-r from-blue-900 to-blue-600 text-white py-20 md:py-32">
        <div class="container mx-auto px-4">
            <div class="grid md:grid-cols-2 gap-8 items-center">
                <div class="animate-fade-in">
                    <h1 class="text-4xl md:text-5xl lg:text-6xl font-bold mb-6 leading-tight">
                        专业配镜，<br>
                        <span class="text-yellow-300">清晰</span>每一刻
                    </h1>
                    <p class="text-xl mb-8 text-blue-100 max-w-lg">
                        300平米市中心专业眼镜店，30年配镜经验，为您提供一站式配镜服务
                    </p>
                    <div class="flex flex-col sm:flex-row gap-4">
                        <a class="bg-white text-primary hover:bg-gray-100 px-8 py-3 rounded-full font-bold transition-colors" href="#products" role="button" aria-label="浏览产品">
                            <i class="fa fa-search mr-2" aria-hidden="true"></i>浏览产品
                        </a>
                        <a class="bg-transparent border-2 border-white hover:bg-white hover:text-primary px-8 py-3 rounded-full font-bold transition-colors" href="#services" role="button" aria-label="立即预约">
                            <i class="fa fa-calendar mr-2" aria-hidden="true"></i>立即预约
                        </a>
                    </div>
                </div>
                <div class="hidden md:block animate-slide-up">
                    <!-- hero 图片建议本地化到 /assets/hero.jpg 并替换 src-->
                    <img src="https://p3-doubao-search-sign.byteimg.com/labis/982787b9fe2cc6afe2ff0882f275b0c0~tplv-be4g95zd3a-image.jpeg" alt="眼镜店环境" class="rounded-lg shadow-2xl w-full" loading="eager">
                </div>
            </div>
        </div>

        <div class="absolute bottom-0 left-0 w-full overflow-hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320" class="w-full" aria-hidden="true">
                <path fill="#ffffff" fill-opacity="1" d="M0,224L48,213.3C96,203,192,181,288,181.3C384,181,480,203,576,202.7C672,203,768,181,864,181.3C960,181,1056,203,1152,202.7C1248,203,1344,181,1392,170.7L1440,160L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path>
            </svg>
        </div>
    </section>

    <!-- 特色服务（略：保持原结构） -->
    <section class="py-16 bg-white">
        <div class="container mx-auto px-4">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-gray-800 mb-4">我们的特色服务</h2>
                <p class="text-gray-600 max-w-2xl mx-auto">30年专业配镜经验，为您提供全方位的视力健康服务</p>
            </div>

            <div class="grid md:grid-cols-3 gap-8">
                <div class="bg-white p-6 rounded-xl shadow-lg card-hover" role="article" aria-labelledby="service-1">
                    <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mb-6 mx-auto">
                        <i class="fa fa-eye text-primary text-2xl" aria-hidden="true"></i>
                    </div>
                    <h3 id="service-1" class="text-xl font-bold text-center mb-4">专业验光</h3>
                    <p class="text-gray-600 text-center">使用先进设备进行精准验光，专业验光师一对一服务，确保配镜准确舒适</p>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-lg card-hover" role="article" aria-labelledby="service-2">
                    <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mb-6 mx-auto">
                        <i class="fa fa-magic text-primary text-2xl" aria-hidden="true"></i>
                    </div>
                    <h3 id="service-2" class="text-xl font-bold text-center mb-4">AR虚拟试戴</h3>
                    <p class="text-gray-600 text-center">通过AR技术，在线试戴各种眼镜款式，找到最适合您的那一款</p>
                </div>

                <div class="bg-white p-6 rounded-xl shadow-lg card-hover" role="article" aria-labelledby="service-3">
                    <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mb-6 mx-auto">
                        <i class="fa fa-gift text-primary text-2xl" aria-hidden="true"></i>
                    </div>
                    <h3 id="service-3" class="text-xl font-bold text-center mb-4">会员专享</h3>
                    <p class="text-gray-600 text-center">丰富的会员权益，积分兑换、生日礼遇、定期眼部检查等专属服务</p>
                </div>
            </div>
        </div>
    </section>

    <!-- 产品（略：主要改动是给 img 加上 loading="lazy"） -->
    <section id="products" class="py-16 bg-gray-50">
        <div class="container mx-auto px-4">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-gray-800 mb-4">精选产品</h2>
                <p class="text-gray-600 max-w-2xl mx-auto">多种风格，满足不同需求，价格区间300-700元</p>
            </div>

            <div class="flex flex-wrap justify-center gap-4 mb-10">
                <button class="bg-primary text-white px-6 py-2 rounded-full">全部</button>
                <button class="bg-white hover:bg-gray-100 text-gray-700 px-6 py-2 rounded-full transition-colors">近视眼镜</button>
                <button class="bg-white hover:bg-gray-100 text-gray-700 px-6 py-2 rounded-full transition-colors">太阳镜</button>
                <button class="bg-white hover:bg-gray-100 text-gray-700 px-6 py-2 rounded-full transition-colors">老花镜</button>
                <button class="bg-white hover:bg-gray-100 text-gray-700 px-6 py-2 rounded-full transition-colors">隐形眼镜</button>
            </div>

            <div class="grid sm:grid-cols-2 lg:grid-cols-4 gap-6">
                <div class="bg-white rounded-xl overflow-hidden shadow-lg card-hover">
                    <div class="relative">
                        <img src="https://p11-doubao-search-sign.byteimg.com/tos-cn-i-xv4ileqgde/885644413ccc449abd3759ac79f472ae~tplv-be4g95zd3a-image.jpeg" alt="商务款眼镜" class="w-full h-48 object-cover" loading="lazy">
                        <div class="absolute top-3 right-3 bg-red-500 text-white text-xs px-2 py-1 rounded">热销</div>
                    </div>
                    <div class="p-4">
                        <h3 class="font-bold text-lg mb-2">商务精英款</h3>
                        <p class="text-gray-600 text-sm mb-3">经典商务风格，适合办公和正式场合</p>
                        <div class="flex justify-between items-center">
                            <span class="text-primary font-bold text-xl">¥499</span>
                            <button class="bg-primary hover:bg-blue-700 text-white px-4 py-2 rounded-full text-sm transition-colors" aria-label="购买 商务精英款">
                                立即购买
                            </button>
                        </div>
                    </div>
                </div>

                <!-- 其余产品项省略，但同样添加 loading="lazy" -->
            </div>

            <div class="text-center mt-10">
                <button class="border-2 border-primary text-primary hover:bg-primary hover:text-white px-8 py-3 rounded-full font-bold transition-colors">查看更多产品</button>
            </div>
        </div>
    </section>

    <!-- 数字化展示（保留结构） -->
    <section class="py-16 bg-white">
        <div class="container mx-auto px-4">
            <div class="grid md:grid-cols-2 gap-8 items-center">
                <div>
                    <img src="https://p3-flow-imagex-sign.byteimg.com/tos-cn-i-a9rns2rl98/rc/pc/super_tool/af7fa89121f84c9ba7ea12edba52a3b9~tplv-a9rns2rl98-image.image" alt="数字化展示屏" class="rounded-lg shadow-xl w-full" loading="lazy">
                </div>
                <div>
                    <h2 class="text-3xl font-bold text-gray-800 mb-6">数字化产品展示</h2>
                    <p class="text-gray-600 mb-6 text-lg">通过高清数字屏幕，展示最新产品和促销信息，让您一目了然地了解所有选择。</p>
                    <ul class="space-y-4">
                        <li class="flex items-start">
                            <div class="bg-blue-100 rounded-full p-2 mr-4 mt-1"><i class="fa fa-check text-primary" aria-hidden="true"></i></div>
                            <div><h4 class="font-bold text-gray-800">360°全方位展示</h4><p class="text-gray-600">查看眼镜的每个细节，从不同角度欣赏</p></div>
                        </li>
                        <li class="flex items-start">
                            <div class="bg-blue-100 rounded-full p-2 mr-4 mt-1"><i class="fa fa-check text-primary" aria-hidden="true"></i></div>
                            <div><h4 class="font-bold text-gray-800">实时促销信息</h4><p class="text-gray-600">第一时间了解最新优惠活动</p></div>
                        </li>
                        <li class="flex items-start">
                            <div class="bg-blue-100 rounded-full p-2 mr-4 mt-1"><i class="fa fa-check text-primary" aria-hidden="true"></i></div>
                            <div><h4 class="font-bold text-gray-800">产品对比功能</h4><p class="text-gray-600">轻松比较不同款式的特点和价格</p></div>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <!-- 预约服务（表单已改进：id/name/required/pattern + JS 验证） -->
    <section id="services" class="py-16 bg-gray-50">
        <div class="container mx-auto px-4">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-gray-800 mb-4">预约服务</h2>
                <p class="text-gray-600 max-w-2xl mx-auto">提前预约，节省您的宝贵时间</p>
            </div>

            <div class="grid md:grid-cols-2 gap-8 items-center">
                <div class="bg-white p-8 rounded-xl shadow-lg">
                    <h3 class="text-2xl font-bold text-gray-800 mb-6">在线预约</h3>
                    <form id="appointment-form" novalidate>
                        <div class="grid sm:grid-cols-2 gap-6 mb-6">
                            <div>
                                <label for="name" class="block text-gray-700 font-medium mb-2">姓名</label>
                                <input id="name" name="name" type="text" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary" placeholder="请输入您的姓名" aria-required="true">
                                <p class="text-red-600 text-sm mt-1 hidden" id="name-error" role="alert"></p>
                            </div>
                            <div>
                                <label for="phone" class="block text-gray-700 font-medium mb-2">手机号码</label>
                                <input id="phone" name="phone" type="tel" required pattern="^1[3-9]\\d{9}$" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary" placeholder="请输入您的手机号码" aria-required="true">
                                <p class="text-red-600 text-sm mt-1 hidden" id="phone-error" role="alert"></p>
                            </div>
                        </div>

                        <div class="mb-6">
                            <label for="service-type" class="block text-gray-700 font-medium mb-2">服务类型</label>
                            <select id="service-type" name="service-type" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary" aria-required="true">
                                <option value="">请选择服务类型</option>
                                <option value="eye-exam">专业验光</option>
                                <option value="glasses-fitting">配镜服务</option>
                                <option value="contact-lens">隐形眼镜咨询</option>
                                <option value="repair">眼镜维修</option>
                            </select>
                            <p class="text-red-600 text-sm mt-1 hidden" id="service-error" role="alert"></p>
                        </div>

                        <div class="grid sm:grid-cols-2 gap-6 mb-6">
                            <div>
                                <label for="date" class="block text-gray-700 font-medium mb-2">预约日期</label>
                                <input id="date" name="date" type="date" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary" aria-required="true">
                                <p class="text-red-600 text-sm mt-1 hidden" id="date-error" role="alert"></p>
                            </div>
                            <div>
                                <label for="time" class="block text-gray-700 font-medium mb-2">预约时间</label>
                                <select id="time" name="time" required class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary" aria-required="true">
                                    <option value="">���选择时间段</option>
                                    <option value="09:00">09:00 - 10:00</option>
                                    <option value="10:00">10:00 - 11:00</option>
                                    <option value="11:00">11:00 - 12:00</option>
                                    <option value="14:00">14:00 - 15:00</option>
                                    <option value="15:00">15:00 - 16:00</option>
                                    <option value="16:00">16:00 - 17:00</option>
                                    <option value="17:00">17:00 - 18:00</option>
                                </select>
                                <p class="text-red-600 text-sm mt-1 hidden" id="time-error" role="alert"></p>
                            </div>
                        </div>

                        <div class="mb-6">
                            <label for="note" class="block text-gray-700 font-medium mb-2">备注信息</label>
                            <textarea id="note" name="note" class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-primary" rows="3" placeholder="请输入您的特殊需求或备注信息"></textarea>
                        </div>

                        <button id="submit-btn" type="submit" class="w-full bg-primary hover:bg-blue-700 text-white py-3 rounded-lg font-bold transition-colors" aria-live="polite">
                            提交预约
                        </button>
                    </form>
                </div>

                <div>
                    <h3 class="text-2xl font-bold text-gray-800 mb-6">我们的专业服务</h3>
                    <div class="space-y-6">
                        <div class="flex">
                            <div class="bg-blue-100 rounded-full p-3 mr-4"><i class="fa fa-stethoscope text-primary text-xl" aria-hidden="true"></i></div>
                            <div>
                                <h4 class="font-bold text-gray-800 text-lg mb-2">专业验光服务</h4>
                                <p class="text-gray-600">由资深验光师使用先进设备，为您提供精准的视力检测和配镜建议</p>
                                <p class="text-primary font-medium mt-2">时长：30分钟</p>
                            </div>
                        </div>

                        <div class="flex">
                            <div class="bg-blue-100 rounded-full p-3 mr-4"><i class="fa fa-glasses text-primary text-xl" aria-hidden="true"></i></div>
                            <div>
                                <h4 class="font-bold text-gray-800 text-lg mb-2">个性化配镜</h4>
                                <p class="text-gray-600">根据您的脸型、需求和预算，推荐最适合的镜框和镜片组合</p>
                                <p class="text-primary font-medium mt-2">时长：45分钟</p>
                            </div>
                        </div>

                        <div class="flex">
                            <div class="bg-blue-100 rounded-full p-3 mr-4"><i class="fa fa-handshake-o text-primary text-xl" aria-hidden="true"></i></div>
                            <div>
                                <h4 class="font-bold text-gray-800 text-lg mb-2">售后保障</h4>
                                <p class="text-gray-600">提供专业的眼镜调整、维修和保养服务，让您的眼镜始终如新</p>
                                <p class="text-primary font-medium mt-2">终身免费调整</p>
                            </div>
                        </div>

                        <div class="mt-8">
                            <img src="https://p11-doubao-search-sign.byteimg.com/tos-cn-i-be4g95zd3a/1053798186467590150~tplv-be4g95zd3a-image.jpeg" alt="验光服务" class="rounded-lg shadow-lg" loading="lazy">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- AR 试戴 -->
    <section id="ar-tryon" class="py-16 bg-white">
        <div class="container mx-auto px-4">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-gray-800 mb-4">AR虚拟试戴</h2>
                <p class="text-gray-600 max-w-2xl mx-auto">足不出户，体验试戴乐趣</p>
            </div>

            <div class="grid md:grid-cols-2 gap-8 items-center">
                <div>
                    <img src="https://p3-flow-imagex-sign.byteimg.com/tos-cn-i-a9rns2rl98/rc/pc/super_tool/f9798221713a4425916eaa9a8cef9c31~tplv-a9rns2rl98-image.image" alt="AR虚拟试戴" class="rounded-lg shadow-xl w-full" loading="lazy">
                </div>
                <div>
                    <h3 class="text-2xl font-bold text-gray-800 mb-6">虚拟试戴，真实体验</h3>
                    <p class="text-gray-600 mb-6 text-lg">通过先进的AR技术，您可以在手机或平板上实时看到自己佩戴不同眼镜的效果，轻松找到最适合您的款式。</p>

                    <div class="space-y-4 mb-8">
                        <div class="flex items-center"><div class="bg-blue-100 rounded-full p-2 mr-4"><i class="fa fa-camera text-primary" aria-hidden="true"></i></div><span class="text-gray-700">打开摄像头，对准面部</span></div>
                        <div class="flex items-center"><div class="bg-blue-100 rounded-full p-2 mr-4"><i class="fa fa-refresh text-primary" aria-hidden="true"></i></div><span class="text-gray-700">选择喜欢的眼镜款式</span></div>
                        <div class="flex items-center"><div class="bg-blue-100 rounded-full p-2 mr-4"><i class="fa fa-check-circle text-primary" aria-hidden="true"></i></div><span class="text-gray-700">查看试戴效果，保存分享</span></div>
                    </div>

                    <button id="start-ar-btn" class="bg-primary hover:bg-blue-700 text-white px-8 py-3 rounded-full font-bold transition-colors" aria-label="开始 AR 试戴">
                        <i class="fa fa-play-circle mr-2" aria-hidden="true"></i>开始AR试戴
                    </button>
                </div>
            </div>

            <div class="mt-16 bg-gray-50 p-8 rounded-xl">
                <h3 class="text-2xl font-bold text-gray-800 mb-6 text-center">AR试戴演示</h3>

                <div class="grid md:grid-cols-3 gap-8">
                    <div class="md:col-span-2 bg-white rounded-lg overflow-hidden shadow-lg">
                        <div class="aspect-video bg-gray-200 flex items-center justify-center relative" id="ar-demo-area" aria-live="polite">
                            <div class="text-center" id="ar-placeholder">
                                <i class="fa fa-camera text-6xl text-gray-400 mb-4" aria-hidden="true"></i>
                                <p class="text-gray-600">点击下方按钮开始试戴</p>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white rounded-lg shadow-lg p-4">
                        <h4 class="font-bold text-gray-800 mb-4">选择眼镜款式</h4>
                        <div class="space-y-4">
                            <div class="border-2 border-primary rounded-lg p-2 cursor-pointer bg-blue-50" tabindex="0" role="button" aria-pressed="false">
                                <img src="https://p11-doubao-search-sign.byteimg.com/tos-cn-i-xv4ileqgde/885644413ccc449abd3759ac79f472ae~tplv-be4g95zd3a-image.jpeg" alt="商务款眼镜" class="w-full h-24 object-cover rounded" loading="lazy">
                                <p class="text-center font-medium mt-2">商务精英款</p>
                            </div>
                            <div class="border-2 border-transparent hover:border-primary rounded-lg p-2 cursor-pointer hover:bg-blue-50 transition-colors" tabindex="0">
                                <img src="https://p3-doubao-search-sign.byteimg.com/tos-cn-i-xv4ileqgde/b367646a762c48d8aed331f7051c9f51~tplv-be4g95zd3a-image.jpeg" alt="时尚款眼镜" class="w-full h-24 object-cover rounded" loading="lazy">
                                <p class="text-center font-medium mt-2">时尚潮流款</p>
                            </div>
                            <div class="border-2 border-transparent hover;border-primary rounded-lg p-2 cursor-pointer hover:bg-blue-50 transition-colors" tabindex="0">
                                <img src="https://p3-doubao-search-sign.byteimg.com/tos-cn-i-xv4ileqgde/b9e17d505c7844a28693b39827944e02~tplv-be4g95zd3a-image.jpeg" alt="太阳镜" class="w-full h-24 object-cover rounded" loading="lazy">
                                <p class="text-center font-medium mt-2">经典太阳镜</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="mt-8 text-center">
                    <button id="start-ar-demo" class="bg-primary hover:bg-blue-700 text-white px-8 py-3 rounded-full font-bold transition-colors" aria-label="启动摄像头(演示区)">
                        <i class="fa fa-video-camera mr-2" aria-hidden="true"></i>启动摄像头
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- 会员/数据/联系/页脚等（保持原结构，图片添加 lazy） -->
    <!-- ...（为简洁示例省略中间重复部分；实际文件请保留或我可提供全量版本） ... -->

    <!-- 返回顶部按钮 -->
    <button id="back-to-top" class="fixed bottom-8 right-8 bg-primary hover:bg-blue-700 text-white w-12 h-12 rounded-full flex items-center justify-center shadow-lg transition-all opacity-0 invisible" aria-hidden="true" aria-label="返回顶部">
        <i class="fa fa-arrow-up" aria-hidden="true"></i>
    </button>

    <!-- JS: 交互逻辑（DOM 安全操作、表单验证、AR 摄像头检测） -->
    <script>
    (function () {
        // Mobile menu toggle
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');
        mobileMenuButton.addEventListener('click', function () {
            const expanded = mobileMenu.classList.toggle('hidden');
            this.setAttribute('aria-expanded', String(!expanded));
            mobileMenu.setAttribute('aria-hidden', String(expanded));
        });

        // Smooth scroll for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                const targetId = this.getAttribute('href');
                if (!targetId || targetId === '#') return;
                const targetElement = document.querySelector(targetId);
                if (targetElement) {
                    e.preventDefault();
                    window.scrollTo({ top: targetElement.offsetTop - 80, behavior: 'smooth' });
                    if (!mobileMenu.classList.contains('hidden')) mobileMenu.classList.add('hidden');
                }
            });
        });

        // Back to top
        const backToTopButton = document.getElementById('back-to-top');
        function handleScroll() {
            if (window.pageYOffset > 300) {
                backToTopButton.classList.remove('opacity-0', 'invisible');
                backToTopButton.classList.add('opacity-100', 'visible');
                backToTopButton.setAttribute('aria-hidden', 'false');
            } else {
                backToTopButton.classList.remove('opacity-100', 'visible');
                backToTopButton.classList.add('opacity-0', 'invisible');
                backToTopButton.setAttribute('aria-hidden', 'true');
            }
        }
        window.addEventListener('scroll', handleScroll);
        backToTopButton.addEventListener('click', function () { window.scrollTo({ top: 0, behavior: 'smooth' }); });

        // Appointment form validation + submission (no innerHTML injection)
        const form = document.getElementById('appointment-form');
        const submitBtn = document.getElementById('submit-btn');

        function showFieldError(id, message) {
            const el = document.getElementById(id + '-error');
            if (el) {
                el.textContent = message;
                el.classList.remove('hidden');
            }
        }
        function clearFieldError(id) {
            const el = document.getElementById(id + '-error');
            if (el) { el.textContent = ''; el.classList.add('hidden'); }
        }

        form.addEventListener('submit', function (e) {
            e.preventDefault();
            // Basic validation
            let valid = true;
            const name = form.querySelector('#name');
            const phone = form.querySelector('#phone');
            const service = form.querySelector('#service-type');
            const date = form.querySelector('#date');
            const time = form.querySelector('#time');

            // Reset errors
            ['name','phone','service','date','time'].forEach(clearFieldError);

            if (!name.value.trim()) { showFieldError('name', '请输入姓名'); valid = false; }
            const phonePattern = /^1[3-9]\d{9}$/;
            if (!phonePattern.test(phone.value.trim())) { showFieldError('phone', '请输入有效的大陆手机号'); valid = false; }
            if (!service.value) { showFieldError('service', '请选择服务类型'); valid = false; }
            if (!date.value) { showFieldError('date', '请选择预约日期'); valid = false; }
            if (!time.value) { showFieldError('time', '请选择时间段'); valid = false; }

            if (!valid) {
                // focus first invalid
                const firstError = form.querySelector('.text-red-600:not(.hidden)');
                if (firstError) firstError.previousElementSibling?.focus();
                return;
            }

            // Simulate submit
            submitBtn.disabled = true;
            const originalText = submitBtn.textContent;
            submitBtn.textContent = '提交中...';

            // Simulated network delay
            setTimeout(() => {
                submitBtn.textContent = '预约成功';
                submitBtn.classList.remove('bg-primary');
                submitBtn.classList.add('bg-green-600');

                // show success message element appended to form (DOM-safe)
                const msg = document.createElement('div');
                msg.className = 'mt-4 bg-green-100 text-green-700 p-4 rounded-lg';
                msg.setAttribute('role','status');
                const inner = document.createElement('div');
                inner.className = 'flex items-center';
                const icon = document.createElement('i');
                icon.className = 'fa fa-check-circle text-green-500 text-xl mr-3';
                icon.setAttribute('aria-hidden','true');
                const wrap = document.createElement('div');
                const p1 = document.createElement('p');
                p1.className = 'font-bold'; p1.textContent = '预约成功！';
                const p2 = document.createElement('p');
                p2.textContent = '我们将在24小时内与您联系确认预约详情。';
                wrap.appendChild(p1); wrap.appendChild(p2);
                inner.appendChild(icon); inner.appendChild(wrap);
                msg.appendChild(inner);
                form.parentElement.appendChild(msg);

                setTimeout(() => {
                    form.reset();
                    submitBtn.disabled = false;
                    submitBtn.textContent = originalText;
                    submitBtn.classList.remove('bg-green-600');
                    submitBtn.classList.add('bg-primary');
                    if (msg.parentElement) msg.parentElement.removeChild(msg);
                }, 5000);
            }, 1200);
        });

        // AR demo / camera handling (DOM-safe, permission/error handling)
        const startArBtn = document.getElementById('start-ar-btn');
        const arDemoArea = document.getElementById('ar-demo-area');
        const arPlaceholder = document.getElementById('ar-placeholder');
        let currentStream = null;

        async function stopStream() {
            if (currentStream) {
                currentStream.getTracks().forEach(t => t.stop());
                currentStream = null;
            }
            const existingVideo = arDemoArea.querySelector('video');
            if (existingVideo && existingVideo.parentElement) existingVideo.parentElement.removeChild(existingVideo);
        }

        async function startCameraDemo() {
            // Clear placeholder
            if (arPlaceholder) arPlaceholder.style.display = 'none';

            // If browser supports getUserMedia
            if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
                try {
                    const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: 'user' }, audio: false });
                    currentStream = stream;
                    const video = document.createElement('video');
                    video.autoplay = true;
                    video.playsInline = true;
                    video.muted = true;
                    video.srcObject = stream;
                    video.className = 'w-full h-full object-cover';
                    // overlay controls container
                    const controls = document.createElement('div');
                    controls.className = 'absolute bottom-4 left-0 right-0 flex justify-center space-x-4';
                    // buttons
                    const captureBtn = document.createElement('button');
                    captureBtn.className = 'bg-white text-primary px-4 py-2 rounded-full';
                    captureBtn.textContent = '拍照';
                    captureBtn.addEventListener('click', () => {
                        // simple capture to image — create canvas and download
                        try {
                            const canvas = document.createElement('canvas');
                            canvas.width = video.videoWidth;
                            canvas.height = video.videoHeight;
                            const ctx = canvas.getContext('2d');
                            ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
                            const a = document.createElement('a');
                            a.href = canvas.toDataURL('image/png');
                            a.download = 'ar-capture.png';
                            a.click();
                        } catch (err) {
                            console.warn('截图失败', err);
                        }
                    });
                    const switchBtn = document.createElement('button');
                    switchBtn.className = 'bg-white text-primary px-4 py-2 rounded-full';
                    switchBtn.textContent = '切换款式';
                    // simple placeholder action for switch
                    switchBtn.addEventListener('click', () => alert('切换款式（示例）'));
                    const confirmBtn = document.createElement('button');
                    confirmBtn.className = 'bg-white text-primary px-4 py-2 rounded-full';
                    confirmBtn.textContent = '确认';
                    confirmBtn.addEventListener('click', () => alert('已确认（示例）'));
                    controls.appendChild(captureBtn); controls.appendChild(switchBtn); controls.appendChild(confirmBtn);

                    // append to demo area
                    // ensure demo area is empty
                    while (arDemoArea.firstChild) arDemoArea.removeChild(arDemoArea.firstChild);
                    arDemoArea.appendChild(video);
                    arDemoArea.appendChild(controls);
                } catch (err) {
                    console.error('无法访问摄像头', err);
                    // fallback to image preview
                    renderArFallback('camera-permission-denied');
                }
            } else {
                // no camera support
                renderArFallback('no-camera');
            }
        }

        function renderArFallback(reason) {
            while (arDemoArea.firstChild) arDemoArea.removeChild(arDemoArea.firstChild);
            const wrapper = document.createElement('div');
            wrapper.className = 'w-full h-full flex items-center justify-center bg-black relative';
            const img = document.createElement('img');
            img.src = 'https://p3-flow-imagex-sign.byteimg.com/tos-cn-i-a9rns2rl98/rc/pc/super_tool/f9798221713a4425916eaa9a8cef9c31~tplv-a9rns2rl98-image.image';
            img.alt = 'AR试戴效果（备用）';
            img.className = 'w-full h-full object-cover';
            wrapper.appendChild(img);
            const info = document.createElement('div');
            info.className = 'absolute inset-0 flex items-center justify-center';
            const p = document.createElement('p');
            p.className = 'text-white text-center bg-black/50 p-4 rounded';
            p.textContent = (reason === 'no-camera') ? '您的设备或浏览器不支持摄像头访问，已启用演示预览' : '摄像头权限被拒绝，已启用演示预览';
            info.appendChild(p);
            wrapper.appendChild(info);
            arDemoArea.appendChild(wrapper);
        }

        document.getElementById('start-ar-demo').addEventListener('click', function () {
            startCameraDemo();
        });
        // also wire the other button
        const startArPrimary = document.getElementById('start-ar-btn');
        if (startArPrimary) startArPrimary.addEventListener('click', function () {
            startCameraDemo();
        });

        // cleanup on unload
        window.addEventListener('beforeunload', stopStream);

        // Initialize charts after scripts loaded
        document.addEventListener('DOMContentLoaded', function () {
            // safety: only init if Chart exists and canvas present
            if (window.Chart) {
                const salesCanvas = document.getElementById('salesChart');
                if (salesCanvas) {
                    new Chart(salesCanvas.getContext('2d'), {
                        type: 'line',
                        data: {
                            labels: ['1月','2月','3月','4月','5月','6月'],
                            datasets: [{
                                label: '销售额（万元）',
                                data: [12,19,15,17,22,28],
                                backgroundColor: 'rgba(59,130,246,0.1)',
                                borderColor: 'rgba(59,130,246,1)',
                                borderWidth: 2,
                                tension: 0.3,
                                fill: true
                            }]
                        },
                        options: { responsive: true, plugins:{ legend:{ display:false } }, scales:{ y:{ beginAtZero:true } } }
                    });
                }
                const catCanvas = document.getElementById('categoryChart');
                if (catCanvas) {
                    new Chart(catCanvas.getContext('2d'), {
                        type: 'doughnut',
                        data: {
                            labels: ['近视眼镜','太阳镜','老花镜','隐形眼镜','配件'],
                            datasets: [{
                                data: [45,25,15,10,5],
                                backgroundColor: ['rgba(59,130,246,0.8)','rgba(16,185,129,0.8)','rgba(245,158,11,0.8)','rgba(239,68,68,0.8)','rgba(139,92,246,0.8)'],
                                borderWidth: 2, borderColor: '#ffffff'
                            }]
                        },
                        options:{ responsive:true, plugins:{ legend:{ position:'bottom' } } }
                    });
                }
            }
        });
    })();
    </script>

</body>
</html>
